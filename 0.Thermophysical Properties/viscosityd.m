function mu = viscosityd(gastype,Ti)
%Calculation of dynamic viscosity for several gastypes:
%'Air' 'CH4' C3H8' 'C4H10' 'H2O'
%T is defined in [ºC]
% Dynamic viscosity \mu [Pa.s]

mu_CO2=[6.85	1.400E-05
26.85	1.490E-05
46.85	1.560E-05
66.85	1.650E-05
86.85	1.730E-05
106.85	1.810E-05
126.85	1.900E-05
176.85	2.100E-05
226.85	2.310E-05
276.85	2.510E-05
326.85	2.700E-05
376.85	2.880E-05
426.85	3.050E-05
476.85	0.0000321
526.85	0.0000337];

mu_N2=[-173.15	0.00000688
-123.15	0.00001006
-73.15	0.00001292
-23.15	0.00001549
26.85	0.00001782
76.85	0.00002
126.85	0.00002204
176.85	0.00002396
226.85	0.00002577
276.85	0.00002747
326.85	0.00002908
426.85	0.0000321
526.85	0.00003491
626.85	0.00003753
726.85	0.00003999
826.85	0.00004232
926.85	0.00004453
1026.85	0.00004662];

mu_O2=[-173.15	0.00000764
-123.15	0.00001148
-73.15	0.00001475
-23.15	0.00001786
26.85	0.00002072
76.85	0.00002335
126.85	0.00002582
176.85	0.00002814
226.85	0.00003033
276.85	0.0000324
326.85	0.00003437
426.85	0.00003808
526.85	0.00004152
626.85	0.00004472
726.85	0.0000477
826.85	0.00005055
926.85	0.00005325
1026.85	0.00005884];



T=Ti+273.15;
if strcmp(gastype,'Air')==1
    mu=(0.40401+(0.074582*T)-((5.7171*10^-5)*T^2)+((2.9928*10^-8)*T^3)+((-6.2524*10^-12)*(T^4)))*10^-6;
elseif strcmp(gastype,'CH4')==1 || strcmp(gastype,'G20')==1
    mu=(3.1895*10^-8)*T+1.6448*10^-6;
elseif strcmp(gastype,'C3H8')==1 || strcmp(gastype,'G31')==1
    mu=(2.6795*10^-8)*T+1.4814*10^-7;
elseif strcmp(gastype,'C4H10')==1 || strcmp(gastype,'G30')==1
    mu=(2.4795*10^-8)*T+1.0693*10^-8;
elseif strcmp(gastype,'H2O')==1
    mu=(((T/647.27)^(0.5))/((0.01816)+((0.01776)*((647.27)/(T)))+((0.01053)*((647.27/T)^2))-((0.003674)*(((647.27)/(T))^(3)))))*10^-6;
elseif strcmp(gastype,'O2')==1
    mu=interp1(mu_O2(:,1),mu_O2(:,2),Ti);
elseif strcmp(gastype,'N2')==1
    mu=interp1(mu_N2(:,1),mu_N2(:,2),Ti);
elseif strcmp(gastype,'CO2')==1
    mu=interp1(mu_CO2(:,1),mu_CO2(:,2),Ti);    
end

end