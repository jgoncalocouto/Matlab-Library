function [CO_daf]=W2_LPG_StabilityDiagram(gastype,Pi,CO2)

DATA_G31=[48.039	9.53	535
48.025	9.42	314
48.052	9.13	191
47.95	8.74	90
48.09	8.67	56
45.68	9.25	518
45.55	9.06	238
45.57	8.72	114
45.59	8.47	69
50.427	9.97	609
50.46	9.71	351
50.474	9.53	216
50.37	9.18	108
50.35	9.08	85
55.049	10.48	465
54.97	10.34	363
55.1	10.25	294
55.01	10.19	240
5.96	2.35	119
6.016	2.23	24
6	2.11	23
7.902	3.11	215
8.028	2.91	23
8.171	2.72	5
7.815	2.59	7
9.95	3.72	205
9.95	3.6	119
10.051	3.53	54
10.1	3.32	8
10.168	3.15	3
14.008	5.01	185
14.023	4.71	61
13.901	4.33	7
14.116	4.24	4
12.129	4.43	192
12.145	4.19	121
12.007	3.99	35
12.107	3.78	5
12.068	3.51	3];

DATA_G30=[47.95	9.78	465
47.995	9.61	287
48.04	9.51	224
48.2	9.12	111
48.215	9.21	136
48.058	9.2	114
45.59	9.44	380
45.49	9.25	258
45.61	9.05	166
45.488	8.78	96
45.76	8.72	85
50.44	9.35	124
50.44	9.65	156
50.45	9.83	249
50.412	10.14	410
50.364	10.34	744
55.25	10.87	570
54.93	10.59	328
54.85	10.37	211
6.321	2.51	127
6.05	2.28	29
6.15	2.2	29
7.7	3.06	211
7.95	2.99	24
8.2	2.81	10
10.231	3.77	121
10.303	3.64	30
9.924	3.34	7
9.812	3.13	4
10.405	3.33	5
14.187	5.24	195
14.103	4.98	121
13.968	4.59	15
13.953	4.28	8
12.129	4.51	198
12.088	4.15	32
12.041	3.86	7
12.334	3.67	5];

F_G31=scatteredInterpolant(DATA_G31(:,1),DATA_G31(:,2),DATA_G31(:,3));
F_G30=scatteredInterpolant(DATA_G30(:,1),DATA_G30(:,2),DATA_G30(:,3));

[X_CO2_G31,X_H2O_G31,X_N2_G31,X_O2_G31]=exgases_fraction(1,1,1,'G31','dry');
[X_CO2_G30,X_H2O_G30,X_N2_G30,X_O2_G30]=exgases_fraction(1,1,1,'G30','dry');

if strcmp(gastype,'G31')==1
    CO=F_G31(Pi,CO2);
    CO_daf=CO.*((X_CO2_G31.*100)./CO2);
    if CO_daf<0 || CO2<=W2_flameliftlimit(gastype,Pi)
        CO_daf=0;
    end
elseif strcmp(gastype,'G30')==1
    CO=F_G31(Pi,CO2);
    CO_daf=CO.*((X_CO2_G30.*100)./CO2);
    if CO_daf<0 || CO2<=W2_flameliftlimit(gastype,Pi)
        CO_daf=0;
    end
else
    warning('Gas type not supported, data only available for G31 and G30')
end

end




