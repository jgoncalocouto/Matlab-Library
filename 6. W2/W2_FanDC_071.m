
function [N_sol] = W2_FanDC_071(rpm_int)
% Nsol
%1 - Fan Duty Cycle - PWM Modluation
%2 - Air Flow Rate - l/min
%3 - Rotational Speed achieved
%4 - Static Pressure [mbar]
%5 - Fan Power [W]

if rpm_int>=7441.100867
    N_sol=[100  0 7441.100867  20.0592 84.61659319];
end

if rpm_int<=2336.761398
N_sol=[20 1019.047619 2336.761398 0.090039966 12.28852751];
end

    


Vair_vs_DeltaP=[20	0	3.0912
20	169.0862511	2.893387532
20	427.8394535	2.630383604
20	555.9350982	2.263652946
20	714.7736977	1.696010931
20	881.2980359	0.960541076
20	945.3458582	0.558775747
20	1019.641332	0.090039966
28	0	5.21186
28	150	5.18456
28	300	5.02226
28	450	4.72496
28	600	4.29266
28	750	3.72536
28	900	3.02306
28	1050 2.18576
28	1200 1.21346
28	1363 0.003837
40	2.561912895	8.668857387
40	125.5337319	8.402811956
40	269.000854	8.070025619
40	448.3347566	7.838842699
40	550.8112724	7.572338173
40	658.411614	7.20514842
40	755.764304	6.77052912
40	901.793339	5.933800171
40	991.4602904	5.398208711
40	1111.870196	4.695305892
40	1250.213493	3.824804782
40	1365.499573	2.68498719
40	1444.918873	1.981166183
40	1629.376601	0.103698036
60	0	13.1376
60	179.3339026	12.67121708
60	509.8206661	11.73781998
60	832.6216909	10.70345073
60	543.1255337	11.73856601
60	584.1161401	11.7058842
60	640.4782237	11.60634671
60	684.030743	11.33852229
60	965.8411614	10.03443484
60	1142.613151	8.795194535
60	1365.499573	7.01938719
60	1491.033305	5.778999146
60	1608.881298	4.840838941
60	1747.224594	3.365537831
60	1900.939368	1.621781042
60	2016.225448	0.17956345
80	2.561912895	17.27045739
80	184.4577284	16.80413185
80	461.1443211	16.00392963
80	648.1639624	15.60491887
80	709.6498719	15.60629616
80	807.0025619	15.10447686
80	1163.108454	12.76045363
80	1368.061486	11.01784458
80	1608.881298	8.872838941
80	1880.444065	6.022921947
80	1765.157985	7.297139539
80	2090.520922	3.373227669
80	2310.845431	0.152562938
100	0	20.0592
100	281.8104184	19.29271255
100	530.3159693	18.45827908
100	684.030743	18.05852229
100	742.9547395	18.05984219
100	791.6310845	18.06093254
100	999.146029	16.99038087
100	1175.918019	15.88554056
100	1411.614005	13.97562015
100	1529.461998	12.90305995
100	1621.690863	11.89712588
100	1726.729291	10.52187874
100	1847.139197	9.180575918
100	1947.0538	7.973214005
100	2026.4731	7.000592997
100	2149.444919	5.457747566
100	2292.912041	3.51216123
100	2433.81725	1.398517506
100	2497.865073	0.055952178];

Vair_vs_Rpm=[20	3.174603175	2874.268394
20	142.8571429	2811.139626
20	326.984127	2732.279357
20	584.1269841	2573.967409
20	920.6349206	2352.205642
20	1019.047619	2336.761398
28	0	3698.54
28	150	3612.044
28	300	3522.308
28	450	3429.332
28	600	3333.116
28	750	3233.66
28	900	3130.964
28	1050 3025.028
28	1200 2915.852
28	1262.6 2869.330985
40	0 4902.178711
40	228.5714286	4711.795457
40	396.8253968	4696.722956
40	333.3333333	4696.385008
40	492.0634921	4601.421496
40	596.8253968	4490.202663
40	755.5555556	4379.271087
40	844.4444444	4283.935832
40	946.031746	4172.700102
40	1019.047619	4109.216488
40	1120.634921	4045.88495
40	1298.412698	3887.150567
40	1428.571429	3776.066914
40	1558.730159	3680.951325
40	1628.571429	3649.38694
60	0	5972.055888
60	155.5555556	5956.915798
60	260.3174603	5861.66503
60	311.1111111	5829.999261
60	355.5555556	5814.267761
60	406.3492063	5718.729736
60	488.8888889	5655.296814
60	565.0793651	5655.702352
60	1060.31746	5243.168689
60	1466.666667	4830.161898
60	1526.984127	4766.610694
60	1873.015873	4544.899619
60	2012.698413	4449.834722
80	0	6930.139721
80	38.0952381	6914.374426
80	95.23809524	6898.710515
80	155.5555556	6899.031566
80	260.3174603	6692.004351
80	441.2698413	6692.967504
80	634.9206349	6502.38148
80	726.984127	6486.903442
80	1187.301587	6010.311652
80	1355.555556	5851.526576
80	1622.222222	5629.393066
80	1850.793651	5438.992914
80	2073.015873	5264.527031
80	2301.587302	5122.03107
100	0	7441.100867
100	190.4761905	7346.323227
100	285.7142857	7235.053702
100	400	7267.598137
100	501.5873016	7076.522088
100	717.4603175	7029.766921
100	780.952381	6982.200678
100	1069.84127	6744.217385
100	1447.619048	6410.898837
100	1853.968254	5965.955919
100	2149.206349	5743.974485
100	2479.365079	5538.146986];

Vair_vs_Pe=[20	2.688704572	10.25642427
20	115.2249263	10.58896019
20	677.8896402	10.96958676
20	915.7457261	11.31551156
20	1023.175049	12.28852751
28	0	16.355
28	150	16.823225
28	300	17.1488
28	450	17.441075
28	600	17.8094
28	750	18.363125
28	900	19.2116
28	1050	20.464175
28	1200	22.2302
28	1262.6	23.14513314
40	8.000535555	25.64160716
40	588.5762845	26.66517294
40	795.7499887	27.64884535
40	959.4371754	27.98684611
40	1130.801106	28.64617987
40	1268.916908	29.30196147
40	1396.802518	29.9566501
40	1501.666095	30.2883663
40	1632.109253	30.94332817
60	3.127258519	44.55134292
60	192.3899277	44.89207611
60	384.2060466	44.91256928
60	563.2467201	45.89323602
60	678.3445886	46.54655844
60	819.0138411	46.88210003
60	939.2227075	47.21545568
60	1023.629997	47.86549919
60	1105.483837	48.83578272
60	1189.878831	48.52428646
60	1276.847767	49.49511648
60	1473.795377	50.79820917
60	1727.021344	53.06885297
60	1941.863595	53.73283184
60	2005.8064	54.06017616
80	0	66.98645128
80	149.1985119	67.32335908
80	371.7216043	68.62918419
80	645.403859	70.58150067
80	988.1235219	71.25914166
80	1420.406557	75.79250524
80	1735.030077	79.35175989
80	2185.236443	85.48960245
80	2310.589097	88.06709739
100	13.8697809	84.61659319
100	210.8091935	85.27865936
100	479.3599572	85.94837633
100	898.8429553	89.51883391
100	1118.824894	92.10643882
100	1341.380775	95.97637
100	1581.843593	100.1687271
100	1819.72837	102.7582447
100	2026.94306	106.9470497
100	2269.971624	111.7807066
100	2484.867156	116.6113579];



a=1;
for i=1:length(Vair_vs_Rpm)-1
if Vair_vs_Rpm(i,3)>=rpm_int
    if Vair_vs_Rpm(i+1,3)<=rpm_int
        if Vair_vs_Rpm(i,1)==Vair_vs_Rpm(i+1,1)
    N_sol(a,1)=(Vair_vs_Rpm(i,1)+Vair_vs_Rpm(i+1,1))/2;
    N_sol(a,2)=Vair_vs_Rpm(i,2)+((rpm_int-(Vair_vs_Rpm(i,3)))*(Vair_vs_Rpm(i+1,2)-Vair_vs_Rpm(i,2)))/(Vair_vs_Rpm(i+1,3)-Vair_vs_Rpm(i,3));
    N_sol(a,3)=rpm_int;
    a=a+1;
        end
    end
    
end
end

i=1;
[m,n]=size(N_sol);
for i=1:m
for j=1:length(Vair_vs_DeltaP)
if Vair_vs_DeltaP(j,1)==N_sol(i,1)
    if Vair_vs_DeltaP(j,2)<=N_sol(i,2)
        if Vair_vs_DeltaP(j+1,2)>=N_sol(i,2)
            N_sol(i,4)=Vair_vs_DeltaP(j,3)+(((N_sol(i,2)-Vair_vs_DeltaP(j,2))*(Vair_vs_DeltaP(j+1,3)-Vair_vs_DeltaP(j,3)))/(Vair_vs_DeltaP(j+1,2)-Vair_vs_DeltaP(j,2))); %DeltaP interpolado
        end
    end
    
end
end
end

i=1;
[m,n]=size(N_sol);
for i=1:m
for j=1:length(Vair_vs_Pe)
if Vair_vs_Pe(j,1)==N_sol(i,1)
    if Vair_vs_Pe(j,2)<=N_sol(i,2)
        if Vair_vs_Pe(j+1,2)>=N_sol(i,2)
            N_sol(i,5)=Vair_vs_Pe(j,3)+(((N_sol(i,2)-Vair_vs_Pe(j,2))*(Vair_vs_Pe(j+1,3)-Vair_vs_Pe(j,3)))/(Vair_vs_Pe(j+1,2)-Vair_vs_Pe(j,2))); %Pe interpolado
        end
    end
    
end
end
end

end

